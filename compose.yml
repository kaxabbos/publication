networks :
    publication :

services :
    nginx :
        image : nginx:stable-alpine
        ports :
        - 80:80
        volumes :
        - './nginx.conf:/etc/nginx/nginx.conf'
        depends_on :
        - application-server
        - web-server
        networks :
        - publication
    database :
        image :          postgres
        container_name : database
        environment :
            POSTGRES_USER :     postgres
            POSTGRES_PASSWORD : root
            POSTGRES_DB :       publication
        ports :
        - 5432:5432
        networks :
        - publication
    application-server :
        image :          application-server:latest
        build :
            context :    back
            dockerfile : Dockerfile
        container_name : application-server
        ports :
        - 8080:8080
        depends_on :
        - database
        environment :
        - SERVER_PORT=8080
        - SPRING_DATASOURCE_URL=jdbc:postgresql://database/publication
        - SPRING_DATASOURCE_USERNAME=postgres
        - SPRING_DATASOURCE_PASSWORD=root
        - SPRING_JPA_HIBERNATE_DDL_AUTO=update
        networks :
        - publication
    web-server :
        image :          web-server:latest
        build :
            context :    front
            dockerfile : Dockerfile
        container_name : web-server
        ports :
        - 4200:80
        networks :
        - publication